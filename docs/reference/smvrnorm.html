<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate from a Multivariate Normal Distribution — smvrnorm • stevemisc</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Simulate from a Multivariate Normal Distribution — smvrnorm" />
<meta property="og:description" content="smvrnorm() simulates data from a multivariate normal distribution." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stevemisc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/svmiller/stevemisc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate from a Multivariate Normal Distribution</h1>
    <small class="dont-index">Source: <a href='https://github.com/svmiller/stevemisc/blob/master/R/smvrnorm.R'><code>R/smvrnorm.R</code></a></small>
    <div class="hidden name"><code>smvrnorm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>smvrnorm()</code> simulates data from a multivariate normal distribution.</p>
    </div>

    <pre class="usage"><span class='fu'>smvrnorm</span><span class='op'>(</span>
  n <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>mu</span>,
  <span class='va'>sigma</span>,
  tol <span class='op'>=</span> <span class='fl'>1e-06</span>,
  empirical <span class='op'>=</span> <span class='cn'>FALSE</span>,
  eispack <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>seed</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>the number of observations to simulate</p></td>
    </tr>
    <tr>
      <th>mu</th>
      <td><p>a vector of means</p></td>
    </tr>
    <tr>
      <th>sigma</th>
      <td><p>a positive-definite symmetric matrix specifying the covariance matrix of the variables.</p></td>
    </tr>
    <tr>
      <th>tol</th>
      <td><p>tolerance (relative to largest variance) for numerical lack of positive-definiteness in <code>sigma</code>.</p></td>
    </tr>
    <tr>
      <th>empirical</th>
      <td><p>logical. If true, <code>mu</code> and <code>sigma</code> specify the empirical not population mean and covariance matrix.</p></td>
    </tr>
    <tr>
      <th>eispack</th>
      <td><p>logical. values other than FALSE result in an error</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>set an optional seed</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns simulated data from a multivariate normal distribution.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This is a simple port and rename of <code>mvrnorm()</code> from the <span class="pkg">MASS</span> package. I elect
to plagiarize/port it because the <span class="pkg">MASS</span> package conflicts with a lot of things in my workflow,
especially <code><a href='https://dplyr.tidyverse.org/reference/select.html'>select()</a></code>. This is useful for "informal Bayes" approaches to generating quantities
of interest from a regression model.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>B. D. Ripley (1987) <em>Stochastic Simulation.</em> Wiley. Page 98.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='va'>M1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mpg</span> <span class='op'>~</span> <span class='va'>disp</span> <span class='op'>+</span> <span class='va'>cyl</span>, <span class='va'>mtcars</span><span class='op'>)</span>

<span class='fu'>smvrnorm</span><span class='op'>(</span><span class='fl'>100</span>, <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>M1</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/vcov.html'>vcov</a></span><span class='op'>(</span><span class='va'>M1</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        (Intercept)         disp         cyl
#&gt;   [1,]    31.31195 -0.029118551 -0.83814761
#&gt;   [2,]    38.60937 -0.026992253 -1.90387374
#&gt;   [3,]    40.99990  0.000976433 -3.43414173
#&gt;   [4,]    28.48359 -0.033666680 -0.14469984
#&gt;   [5,]    30.20752 -0.034598362 -0.38059611
#&gt;   [6,]    38.01195 -0.010269545 -2.56953700
#&gt;   [7,]    33.30378 -0.024795802 -1.22966773
#&gt;   [8,]    36.57855 -0.021049000 -1.88252148
#&gt;   [9,]    27.95876 -0.026589592 -0.47204836
#&gt;  [10,]    36.32702 -0.023394274 -1.64412634
#&gt;  [11,]    30.52653 -0.020885002 -0.93836777
#&gt;  [12,]    41.09084  0.002544177 -3.39920489
#&gt;  [13,]    37.06990 -0.014911457 -2.13213903
#&gt;  [14,]    27.56352 -0.029701245 -0.33020590
#&gt;  [15,]    37.66006 -0.018357718 -2.21093982
#&gt;  [16,]    36.45667 -0.009922074 -2.28613860
#&gt;  [17,]    28.60326 -0.045715851  0.34335295
#&gt;  [18,]    31.62777 -0.021329236 -1.12687893
#&gt;  [19,]    29.99317 -0.044504022  0.12125811
#&gt;  [20,]    34.54677 -0.017677400 -1.79770677
#&gt;  [21,]    33.87942 -0.033329440 -0.98607811
#&gt;  [22,]    41.18466 -0.011230016 -2.93768190
#&gt;  [23,]    31.56178 -0.020418952 -1.08734510
#&gt;  [24,]    33.92132 -0.024528363 -1.39863227
#&gt;  [25,]    35.16884 -0.014233597 -2.07936856
#&gt;  [26,]    35.53921 -0.028659800 -1.49890126
#&gt;  [27,]    35.59803 -0.012477551 -1.98505201
#&gt;  [28,]    36.68386 -0.018285695 -1.96615832
#&gt;  [29,]    36.71898 -0.008817405 -2.32637793
#&gt;  [30,]    39.94172 -0.007168770 -2.87651263
#&gt;  [31,]    34.97916 -0.017453815 -1.68178376
#&gt;  [32,]    31.92084 -0.035062762 -0.63602071
#&gt;  [33,]    29.62006 -0.042715282 -0.05923353
#&gt;  [34,]    34.83529 -0.006378292 -2.12210647
#&gt;  [35,]    34.45467 -0.016315725 -1.67576197
#&gt;  [36,]    33.08406 -0.020467856 -1.29769780
#&gt;  [37,]    34.79163 -0.026632146 -1.39849752
#&gt;  [38,]    37.56160 -0.018513820 -2.23121534
#&gt;  [39,]    34.69617 -0.007341424 -2.01710084
#&gt;  [40,]    34.46382 -0.021177489 -1.61480062
#&gt;  [41,]    36.09671 -0.021896766 -1.81581854
#&gt;  [42,]    31.76464 -0.027507268 -0.90343193
#&gt;  [43,]    33.23828 -0.024981624 -1.26271439
#&gt;  [44,]    37.04350 -0.015493022 -2.18812032
#&gt;  [45,]    34.78892 -0.034119989 -0.98392735
#&gt;  [46,]    37.15601 -0.017751090 -2.08350041
#&gt;  [47,]    38.40107 -0.011998566 -2.52123951
#&gt;  [48,]    34.05663 -0.021965988 -1.33748930
#&gt;  [49,]    34.93979 -0.020690789 -1.67526513
#&gt;  [50,]    35.90926 -0.022055777 -1.73001615
#&gt;  [51,]    33.75420 -0.028114387 -1.26849898
#&gt;  [52,]    32.78031 -0.023853990 -1.22232115
#&gt;  [53,]    33.58576 -0.010131987 -1.89921825
#&gt;  [54,]    35.02440 -0.023900104 -1.35673964
#&gt;  [55,]    35.78827 -0.015085305 -1.89296654
#&gt;  [56,]    34.59310 -0.036729910 -1.00424253
#&gt;  [57,]    33.47848 -0.034458588 -0.86862296
#&gt;  [58,]    34.84807 -0.032277341 -1.26861915
#&gt;  [59,]    32.09024 -0.016165488 -1.37131589
#&gt;  [60,]    33.86291 -0.026025330 -1.14298019
#&gt;  [61,]    32.71275 -0.039110687 -0.35356630
#&gt;  [62,]    35.50936 -0.021467326 -1.67279887
#&gt;  [63,]    30.13142 -0.048942618  0.11910239
#&gt;  [64,]    34.07559 -0.010991752 -1.87408733
#&gt;  [65,]    30.43592 -0.029185267 -0.66189290
#&gt;  [66,]    32.98894 -0.021922119 -1.28730972
#&gt;  [67,]    35.83698 -0.013260916 -2.01926778
#&gt;  [68,]    34.89535 -0.022845405 -1.50334743
#&gt;  [69,]    35.17625 -0.025086540 -1.59730974
#&gt;  [70,]    33.79347 -0.030839078 -1.08872486
#&gt;  [71,]    36.98113 -0.022268469 -1.96441581
#&gt;  [72,]    37.41765 -0.019813942 -2.09702402
#&gt;  [73,]    34.64266 -0.005951515 -2.16653371
#&gt;  [74,]    37.24913 -0.024452082 -1.81182963
#&gt;  [75,]    31.56502 -0.024442617 -1.00969351
#&gt;  [76,]    36.28808 -0.023964492 -1.61677373
#&gt;  [77,]    35.56202 -0.021467283 -1.57394897
#&gt;  [78,]    35.82075 -0.020834208 -1.68482605
#&gt;  [79,]    30.37089 -0.032418418 -0.55555612
#&gt;  [80,]    36.63187 -0.018991060 -1.85064485
#&gt;  [81,]    33.54885 -0.030629085 -1.07916811
#&gt;  [82,]    34.99039 -0.024650266 -1.48952623
#&gt;  [83,]    32.69577 -0.036704046 -0.52629587
#&gt;  [84,]    35.26932  0.001560977 -2.46173284
#&gt;  [85,]    35.44280 -0.008901363 -2.07680301
#&gt;  [86,]    36.64995 -0.013754358 -2.28509144
#&gt;  [87,]    36.53738 -0.021464306 -1.58318750
#&gt;  [88,]    32.80064 -0.035339856 -0.83387346
#&gt;  [89,]    35.09901 -0.017235420 -1.75412312
#&gt;  [90,]    32.13571 -0.023990291 -0.98596091
#&gt;  [91,]    34.95887 -0.027877919 -1.42226747
#&gt;  [92,]    30.59559 -0.015689298 -1.05185122
#&gt;  [93,]    32.68103 -0.023042899 -1.23579633
#&gt;  [94,]    32.81399 -0.028305369 -0.91630765
#&gt;  [95,]    36.13617 -0.009710292 -2.43068148
#&gt;  [96,]    33.34523 -0.020116986 -1.47035170
#&gt;  [97,]    32.66358 -0.026009055 -1.12309193
#&gt;  [98,]    34.96208 -0.025062300 -1.57416583
#&gt;  [99,]    36.51065 -0.031971494 -1.52154802
#&gt; [100,]    32.35252 -0.035139914 -0.69546033</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Miller.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


